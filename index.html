<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üî• GOLD OPTIONS PRO v2 - Trading Terminal</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='75' font-size='75' fill='%23FFD700'>üî•</text></svg>">
    
    <!-- CSS -->
    <link rel="stylesheet" href="/trading-data/css/base.css">
    <link rel="stylesheet" href="/trading-data/css/components/modal.css">
    <link rel="stylesheet" href="/trading-data/css/components/cards.css">
    <link rel="stylesheet" href="/trading-data/css/components/table.css">
    <link rel="stylesheet" href="/trading-data/css/pages/terminal.css">
    
    <!-- Meta -->
    <meta name="description" content="Professional Gold Options Trading Terminal">
    <meta name="theme-color" content="#050505">
</head>
<body>
    <!-- üî• –ó–ê–ì–†–£–ó–ö–ê FIREBASE –ö–û–ù–§–ò–ì–ê -->
    <script id="firebase-config-loader" src="/trading-data/firebase-config.js?nocache=1"></script>
    
    <!-- üî• FIREBASE SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-analytics.js"></script>
    
    <!-- üìä CHART.JS -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <!-- LOADING SCREEN -->
    <div id="loading" style="
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: linear-gradient(135deg, #050505 0%, #0f0f0f 100%);
        display: flex; justify-content: center; align-items: center;
        z-index: 99999; flex-direction: column;
    ">
        <div style="
            font-size: 4rem; margin-bottom: 30px; color: #FFD700;
            animation: pulse 1s infinite;
        ">üî•</div>
        <div style="
            font-size: 2rem; color: #FFD700; font-weight: 800;
            margin-bottom: 20px; letter-spacing: 2px;
        ">GOLD OPTIONS PRO</div>
        <div style="
            font-size: 1rem; color: #888; margin-bottom: 30px;
            letter-spacing: 1px;
        ">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã...</div>
        <div style="
            width: 300px; height: 4px; background: rgba(255,215,0,0.2);
            border-radius: 2px; overflow: hidden;
        ">
            <div style="
                height: 100%; background: linear-gradient(90deg, #FFD700, #D4AF37);
                width: 30%; animation: loading 1.5s infinite;
            "></div>
        </div>
    </div>
    
    <!-- AUTH MODAL -->
    <div id="auth-modal" class="hidden" style="
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.95); backdrop-filter: blur(20px);
        display: flex; justify-content: center; align-items: center;
        z-index: 9999; opacity: 0; transition: opacity 0.5s ease;
    ">
        <div class="auth-container">
            <div class="auth-header">
                <div class="auth-logo">‚ö° GOLD OPTIONS PRO</div>
                <div class="auth-subtitle">Professional Trading Terminal</div>
            </div>
            
            <div id="auth-error" class="auth-error"></div>
            <div id="user-info" style="display: none;"></div>
            
            <div id="auth-form-container" class="auth-form">
                <div class="form-group">
                    <label class="form-label">üìß Email</label>
                    <input type="email" id="auth-email" class="form-input" placeholder="your@email.com">
                </div>
                
                <div class="form-group">
                    <label class="form-label">üîê –ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="auth-password" class="form-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
                </div>
                
                <button id="auth-login-btn" class="auth-button" onclick="handleLogin()">üöÄ –í–û–ô–¢–ò</button>
                <button id="auth-register-btn" class="auth-button secondary" onclick="toggleAuthMode()">üìù –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø</button>
            </div>
            
            <div id="logout-btn" style="display: none; margin-top: 10px;">
                <button class="auth-button" style="background: rgba(255,23,68,0.1); color: var(--put);" onclick="handleLogout()">
                    üëã –í–´–•–û–î
                </button>
            </div>
            
            <div class="auth-footer">
                <div style="margin-bottom: 15px;">
                    <button style="
                        background: none; border: none; color: var(--gold);
                        cursor: pointer; text-decoration: underline;
                        font-size: 0.85rem;
                    " onclick="showAboutModal()">–û –ø—Ä–æ–≥—Ä–∞–º–º–µ</button>
                    <span style="color: #666;"> | </span>
                    <button style="
                        background: none; border: none; color: var(--gold);
                        cursor: pointer; text-decoration: underline;
                        font-size: 0.85rem;
                    " onclick="openTelegram()">Telegram</button>
                </div>
                <div style="font-size: 0.8rem; color: #666;">
                    ‚úÖ Trial: 3 –¥–Ω—è | üì± –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Telegram
                </div>
            </div>
        </div>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main-content" class="visible" style="display: none;">
        <!-- HEADER -->
        <header>
            <div class="logo">‚ö° GOLD OPTIONS PRO v2</div>
            <nav>
                <a href="#" class="active">–¢–ï–†–ú–ò–ù–ê–õ</a>
                <a href="#analytics">–ê–ù–ê–õ–ò–¢–ò–ö–ê</a>
                <a href="#charts">–ì–†–ê–§–ò–ö–ò</a>
            </nav>
            <div class="user-menu">
                <div class="user-badge">
                    <span>üë§</span>
                    <span id="user-email">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span>
                </div>
                <button class="logout-btn" onclick="handleLogout()">–í–´–•–û–î</button>
            </div>
        </header>

        <!-- STATUS BAR -->
        <div class="container">
            <div class="status-bar">
                <div class="connection-status" id="connStatus">üî¥ CONNECTING...</div>
                <div class="data-grid">
                    <div class="data-box">
                        <div class="data-label">–¶–ï–ù–ê –ó–û–õ–û–¢–ê</div>
                        <div class="data-value price" id="price">$0.00</div>
                    </div>
                    <div class="data-box">
                        <div class="data-label">–í–û–õ–ê–¢–ò–õ–¨–ù–û–°–¢–¨</div>
                        <div class="data-value" id="volatility">0.00%</div>
                    </div>
                    <div class="data-box">
                        <div class="data-label">–ü–û–°–õ–ï–î–ù–ï–ï –û–ë–ù–û–í–õ–ï–ù–ò–ï</div>
                        <div class="data-value" style="font-size: 1.2rem;" id="updated">--:--:--</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- MAIN TITLE -->
        <div class="container">
            <h1 class="main-title">üìä –û–ü–¶–ò–û–ù–ù–ê–Ø –¶–ï–ü–¨</h1>
        </div>

        <!-- CONTROLS -->
        <div class="container">
            <div class="bottom-control-panel">
                <div class="bottom-control-title">‚öôÔ∏è –£–ü–†–ê–í–õ–ï–ù–ò–ï –¢–ï–†–ú–ò–ù–ê–õ–û–ú</div>
                
                <div class="bottom-control-grid">
                    <div class="bottom-control-section">
                        <div class="bottom-control-title">üìÖ –í–´–ë–û–† –≠–ö–°–ü–ò–†–ê–¶–ò–ò</div>
                        <div class="control-row" id="dte-buttons">
                            <span style="color:#666;">Loading expirations...</span>
                        </div>
                    </div>
                    
                    <div class="bottom-control-section">
                        <div class="bottom-control-title">üìä –ö–û–õ–ò–ß–ï–°–¢–í–û –°–¢–†–ê–ô–ö–û–í</div>
                        <div class="control-row">
                            <button class="btn" data-cnt="7" onclick="App.setStrikeCount(7)">7</button>
                            <button class="btn" data-cnt="15" onclick="App.setStrikeCount(15)" style="background: var(--gradient-gold); color: #000;">15</button>
                            <button class="btn" data-cnt="21" onclick="App.setStrikeCount(21)">21</button>
                            <button class="btn" data-cnt="31" onclick="App.setStrikeCount(31)">31</button>
                        </div>
                    </div>
                    
                    <div class="bottom-control-section">
                        <div class="bottom-control-title">üíé –û–ü–¶–ò–ò</div>
                        <div class="control-row">
                            <button id="btn-prem" class="btn" onclick="App.togglePremium()">–ü–†–ï–ú–ò–ò: OFF</button>
                        </div>
                    </div>
                </div>
                
                <div class="control-row" style="margin-top: 15px; padding: 0 15px;">
                    <div class="control-label">‚¨ÜÔ∏è FORWARD ADJ:</div>
                    <input type="number" id="forward-adj" class="inp" placeholder="0" onchange="App.applyForwardAdjustment()">
                </div>
            </div>
        </div>

        <!-- TABLE AND STATS -->
        <div class="container">
            <div class="main-table-container">
                <div class="table-wrapper">
                    <div class="table-controls">
                        <div style="color: var(--gold); font-weight: 700;" id="table-dte-label">EXPIRATION: LOADING...</div>
                    </div>
                    <div class="table-scroll">
                        <table>
                            <thead>
                                <tr>
                                    <th>CALL OI</th>
                                    <th>CALL VOL</th>
                                    <th>C PREM</th>
                                    <th>DELTA</th>
                                    <th>GAMMA</th>
                                    <th>IV</th>
                                    <th>STRIKE</th>
                                    <th>IV</th>
                                    <th>GAMMA</th>
                                    <th>DELTA</th>
                                    <th>P PREM</th>
                                    <th>PUT VOL</th>
                                    <th>PUT OI</th>
                                </tr>
                            </thead>
                            <tbody id="table-body">
                                <tr>
                                    <td colspan="13" style="text-align: center; color: #666; padding: 50px;">Loading data...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="top-stats-sidebar">
                    <div class="top-stats-title">üìä TOP STATS</div>
                    <div class="top-stats-grid">
                        <div class="top-stat-box">
                            <div class="top-stat-header">
                                <div class="top-stat-name">TOP CALL OI</div>
                                <div class="top-stat-icon">üìà</div>
                            </div>
                            <div class="top-stat-list" id="top-call-oi"></div>
                        </div>
                        
                        <div class="top-stat-box">
                            <div class="top-stat-header">
                                <div class="top-stat-name">TOP PUT OI</div>
                                <div class="top-stat-icon">üìâ</div>
                            </div>
                            <div class="top-stat-list" id="top-put-oi"></div>
                        </div>
                        
                        <div class="top-stat-box">
                            <div class="top-stat-header">
                                <div class="top-stat-name">TOP CALL VOL</div>
                                <div class="top-stat-icon">üìä</div>
                            </div>
                            <div class="top-stat-list" id="top-call-vol"></div>
                        </div>
                        
                        <div class="top-stat-box">
                            <div class="top-stat-header">
                                <div class="top-stat-name">TOP PUT VOL</div>
                                <div class="top-stat-icon">üìä</div>
                            </div>
                            <div class="top-stat-list" id="top-put-vol"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- CHARTS -->
        <div class="container">
            <h2 class="section-header">üìà –ê–ù–ê–õ–ò–¢–ò–ß–ï–°–ö–ò–ï –ì–†–ê–§–ò–ö–ò</h2>
            <div class="chart-grid-8">
                <div class="chart-container">
                    <div class="chart-title">OI DISTRIBUTION</div>
                    <canvas id="chart-oi"></canvas>
                </div>
                <div class="chart-container">
                    <div class="chart-title">VOLUME HEATMAP</div>
                    <canvas id="chart-vol"></canvas>
                </div>
                <div class="chart-container">
                    <div class="chart-title">IV SMILE</div>
                    <canvas id="chart-iv"></canvas>
                </div>
                <div class="chart-container">
                    <div class="chart-title">MAX PAIN</div>
                    <canvas id="chart-mp"></canvas>
                </div>
                <div class="chart-container">
                    <div class="chart-title">GAMMA EXPOSURE</div>
                    <canvas id="chart-gamma"></canvas>
                </div>
                <div class="chart-container">
                    <div class="chart-title">DELTA PROFILE</div>
                    <canvas id="chart-delta"></canvas>
                </div>
                <div class="chart-container">
                    <div class="chart-title">GEX PROFILE</div>
                    <canvas id="chart-gex"></canvas>
                </div>
                <div class="chart-container">
                    <div class="chart-title">THETA DECAY</div>
                    <canvas id="chart-theta"></canvas>
                </div>
            </div>
        </div>
    </div>

    <!-- JAVASCRIPT -->
    <script src="/trading-data/js/constants.js"></script>
    <script src="/trading-data/js/services/cache.js"></script>
    <script src="/trading-data/js/utils/helpers.js"></script>
    <script src="/trading-data/js/modules/firebase.js"></script>
    <script src="/trading-data/js/modules/auth.js"></script>
    <script src="/trading-data/js/services/api.js"></script>
    <script src="/trading-data/js/modules/charts.js"></script>
    <script src="/trading-data/js/app.js"></script>
    
    <!-- INIT SCRIPT -->
    <script>
        console.log('üöÄ –°–ò–°–¢–ï–ú–ê –ò–ù–ò–¶–ò–ê–õ–ò–ó–ò–†–£–ï–¢–°–Ø...');
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É Firebase –∫–æ–Ω—Ñ–∏–≥–∞
        function checkFirebaseConfig() {
            return new Promise((resolve) => {
                let attempts = 0;
                const maxAttempts = 50; // 5 —Å–µ–∫
                
                const check = setInterval(() => {
                    if (window.firebaseConfig && window.firebaseConfig.projectId) {
                        console.log('‚úÖ Firebase –∫–æ–Ω—Ñ–∏–≥ –∑–∞–≥—Ä—É–∂–µ–Ω!');
                        clearInterval(check);
                        resolve(true);
                    } else if (attempts >= maxAttempts) {
                        console.error('‚ùå Firebase –∫–æ–Ω—Ñ–∏–≥ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è –∑–∞ 5 —Å–µ–∫—É–Ω–¥');
                        clearInterval(check);
                        resolve(false);
                    }
                    attempts++;
                }, 100);
            });
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        async function initializeApp() {
            console.log('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ Firebase –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏...');
            
            const configLoaded = await checkFirebaseConfig();
            
            if (!configLoaded) {
                console.error('‚ùå –û–®–ò–ë–ö–ê: Firebase –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞!');
                const loading = document.getElementById('loading');
                if (loading) {
                    loading.innerHTML = `
                        <div style="
                            font-size: 4rem; margin-bottom: 30px; color: #FF1744;
                        ">‚ùå</div>
                        <div style="
                            font-size: 1.5rem; color: #FF1744; font-weight: 800;
                            margin-bottom: 20px;
                        ">–û–®–ò–ë–ö–ê –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–ò</div>
                        <div style="
                            font-size: 1rem; color: #888; margin-bottom: 20px;
                            text-align: center; max-width: 400px;
                        ">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Firebase.<br>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –∏ GitHub Actions –ª–æ–≥–∏.</div>
                        <button onclick="location.reload()" style="
                            background: var(--gradient-gold); color: #000;
                            border: none; padding: 12px 30px; border-radius: 8px;
                            font-weight: 700; cursor: pointer;
                        ">üîÑ –ü–ï–†–ï–ó–ê–ì–†–£–ó–ò–¢–¨</button>
                    `;
                }
                return;
            }
            
            console.log('‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è AuthModule...');
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Auth
            if (window.AuthModule) {
                await AuthModule.autoInit();
            }
        }
        
        // –ñ–¥—ë–º –∑–∞–≥—Ä—É–∑–∫–∏ DOM
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeApp);
        } else {
            initializeApp();
        }
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function handleLogin() {
            const email = document.getElementById('auth-email').value;
            const password = document.getElementById('auth-password').value;
            
            if (!email || !password) {
                if (window.AuthModule) {
                    AuthModule.showError('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!');
                }
                return;
            }
            
            if (window.AuthModule) {
                AuthModule.login(email, password);
            }
        }
        
        function handleLogout() {
            if (window.AuthModule) {
                AuthModule.logout();
            }
        }
        
        function toggleAuthMode() {
            // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –ø–æ–∑–∂–µ
            alert('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏');
        }
    </script>
    
    <!-- SERVICE WORKER -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/trading-data/service-worker.js')
                .then(reg => console.log('‚úÖ Service Worker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω'))
                .catch(err => console.warn('‚ö†Ô∏è Service Worker –æ—à–∏–±–∫–∞:', err));
        }
    </script>
    
    <!-- ANIMATIONS -->
    <style>
        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }
        
        @keyframes loading {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(300%); }
        }
    </style>
</body>
</html>

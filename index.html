<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>‚ö°</text></svg>">
    <title>üèÜ Gold Options Pro v2 - Professional Trading Terminal</title>
    
    <!-- –°–¢–ò–õ–ò -->
    <link rel="stylesheet" href="./css/base.css">
    <link rel="stylesheet" href="./css/components/cards.css">
    <link rel="stylesheet" href="./css/components/modal.css">
    <link rel="stylesheet" href="./css/components/table.css">
    <link rel="stylesheet" href="./css/pages/terminal.css">
    
    <!-- FIREBASE SDK -->
<script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.5.0/firebase-database-compat.js"></script>

<!-- ‚≠ê FIREBASE CONFIG - –ó–ê–ì–†–£–ñ–ê–ï–ú –ü–ï–†–í–´–ú! -->
<script src="./firebase-config.js"></script>
    
    <!-- SERVICE WORKER -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('./service-worker.js')
                    .then(function(registration) {
                        console.log('‚úÖ Service Worker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω:', registration.scope);
                    })
                    .catch(function(error) {
                        console.warn('‚ö†Ô∏è Service Worker –æ—à–∏–±–∫–∞:', error);
                    });
            });
        }
    </script>
    
    <style>
        body { margin: 0; padding: 0; overflow-x: hidden; }
        #loading {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: #050505;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        .auth-modal {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }
        .auth-modal.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }
        #main-content {
            display: none;
        }
        #main-content.visible {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- –õ–û–ê–î–ï–† -->
    <div id="loading">
        <div style="text-align: center; max-width: 400px; padding: 30px;">
            <div style="font-size: 4rem; margin-bottom: 20px; color: #FFD700;">‚ö°</div>
            <div style="color: #FFD700; font-size: 2rem; font-weight: 800; margin-bottom: 20px; letter-spacing: 2px;">
                GOLD OPTIONS PRO v2
            </div>
            <div style="color: #888; font-size: 1rem; margin-bottom: 30px;">
                –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞...
            </div>
            <div style="width: 300px; height: 4px; background: rgba(255,215,0,0.2); border-radius: 2px; overflow: hidden; margin: 0 auto 30px;">
                <div id="loading-bar" style="height: 100%; background: linear-gradient(90deg, #FFD700, #FFD700); width: 30%;"></div>
            </div>
            <div id="loading-status" style="color: #666; font-size: 0.85rem;">
                üîÑ –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Firebase...
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–ò -->
    <div id="auth-modal" class="auth-modal">
        <!-- [–≤–µ—Å—å –æ—Å—Ç–∞–ª—å–Ω–æ–π HTML –∫–∞–∫ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ] -->
    </div>

    <!-- –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢ -->
    <div id="main-content">
        <!-- [–≤–µ—Å—å –æ—Å—Ç–∞–ª—å–Ω–æ–π HTML –∫–∞–∫ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ] -->
    </div>

    <!-- Chart.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>

    <!-- –ù–ê–®–ò –ú–û–î–£–õ–ò -->
    <script src="./js/constants.js"></script>
    <script src="./js/services/cache.js"></script>
    <script src="./js/modules/firebase.js"></script>
    <script src="./js/modules/auth.js"></script>
    <script src="./js/services/api.js"></script>
    <script src="./js/modules/charts.js"></script>
    <script src="./js/utils/helpers.js"></script>
    <script src="./js/app.js"></script>

    <!-- –ì–õ–ê–í–ù–´–ô –°–ö–†–ò–ü–¢ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–ò -->
    <script>
        console.log('üìÑ –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∂–µ–Ω');
        
        window.appLoaded = false;
        window.firebaseLoaded = false;
        window.configLoaded = false;
        
        function updateLoadingStatus(message, progress) {
            const statusEl = document.getElementById('loading-status');
            const barEl = document.getElementById('loading-bar');
            
            if (statusEl) statusEl.textContent = message;
            if (barEl && progress) barEl.style.width = progress + '%';
        }
        
        function checkAllDependencies() {
            console.group('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π');
            
            let allGood = true;
            
            // 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º firebase-config.js
            if (typeof window.firebaseConfig === 'undefined') {
                console.error('‚ùå window.firebaseConfig –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
                allGood = false;
            } else {
                console.log('‚úÖ window.firebaseConfig –∑–∞–≥—Ä—É–∂–µ–Ω');
                console.log('   –ü—Ä–æ–µ–∫—Ç:', window.firebaseConfig.projectId);
                window.configLoaded = true;
            }
            
            // 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º Firebase SDK
            if (typeof firebase === 'undefined') {
                console.error('‚ùå Firebase SDK –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
                allGood = false;
            } else {
                console.log('‚úÖ Firebase SDK –∑–∞–≥—Ä—É–∂–µ–Ω');
                window.firebaseLoaded = true;
            }
            
            // 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–æ–¥—É–ª–∏
            const requiredModules = ['AuthModule', 'ApiService', 'CacheService', 'ChartsModule', 'app'];
            for (const module of requiredModules) {
                if (typeof window[module] === 'undefined') {
                    console.error(`‚ùå –ú–æ–¥—É–ª—å ${module} –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω`);
                    allGood = false;
                } else {
                    console.log(`‚úÖ –ú–æ–¥—É–ª—å ${module} –∑–∞–≥—Ä—É–∂–µ–Ω`);
                }
            }
            
            console.groupEnd();
            return allGood;
        }
        
        function initializeApplication() {
            console.group('üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è');
            updateLoadingStatus('‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã', 60);
            
            try {
                if (window.FirebaseModule && typeof FirebaseModule.init === 'function') {
                    console.log('üî• –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase...');
                    FirebaseModule.init();
                }
                
                setTimeout(() => {
                    updateLoadingStatus('üéØ –ó–∞–ø—É—Å–∫ –º–æ–¥—É–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏...', 80);
                    
                    if (window.AuthModule && typeof AuthModule.autoInit === 'function') {
                        console.log('üîê –ó–∞–ø—É—Å–∫ AuthModule.autoInit()...');
                        AuthModule.autoInit();
                        window.appLoaded = true;
                        
                        updateLoadingStatus('‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ!', 100);
                        
                        setTimeout(() => {
                            const loadingEl = document.getElementById('loading');
                            if (loadingEl) {
                                loadingEl.style.opacity = '0';
                                setTimeout(() => {
                                    loadingEl.style.display = 'none';
                                }, 500);
                            }
                        }, 500);
                    } else {
                        throw new Error('AuthModule.autoInit –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω');
                    }
                }, 1000);
                
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
                showErrorScreen(error.message);
            }
            
            console.groupEnd();
        }
        
        function showErrorScreen(message) {
            const loadingEl = document.getElementById('loading');
            if (loadingEl) {
                loadingEl.innerHTML = `
                    <div style="text-align: center; padding: 40px; max-width: 600px;">
                        <div style="font-size: 4rem; color: #ff4444; margin-bottom: 20px;">üí•</div>
                        <h2 style="color: #ff4444; margin-bottom: 15px; font-size: 1.8rem;">
                            –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
                        </h2>
                        <div style="background: rgba(255,68,68,0.1); padding: 20px; border-radius: 10px; 
                            margin: 20px 0; text-align: left; color: #ccc; font-size: 0.95rem;">
                            <p style="margin: 0 0 10px 0;"><strong>–°–æ–æ–±—â–µ–Ω–∏–µ –æ—à–∏–±–∫–∏:</strong></p>
                            <pre style="margin: 0; padding: 15px; background: rgba(0,0,0,0.3); 
                                border-radius: 6px; overflow: auto; font-size: 0.85rem;">${message}</pre>
                        </div>
                        
                        <div style="display: flex; flex-direction: column; gap: 10px; margin-top: 30px;">
                            <button onclick="location.reload()" style="padding: 12px 24px; 
                                background: linear-gradient(135deg, #FFD700, #D4AF37); color: #000; border: none; 
                                border-radius: 8px; cursor: pointer; font-weight: 800; font-size: 1rem;">
                                üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
                            </button>
                            
                            <button onclick="window.open('https://t.me/ASKHAT_1985', '_blank')" 
                                style="padding: 12px 24px; background: rgba(33, 150, 243, 0.2); 
                                color: #2196F3; border: 1px solid #2196F3; border-radius: 8px; 
                                cursor: pointer; font-weight: 600;">
                                üìû –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞
                            </button>
                        </div>
                    </div>
                `;
            }
        }
        
        function startApplication() {
            console.log('üé¨ –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');
            updateLoadingStatus('üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π...', 40);
            
            if (checkAllDependencies()) {
                console.log('‚úÖ –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≥–æ—Ç–æ–≤—ã');
                initializeApplication();
            } else {
                console.error('‚ùå –ù–µ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã, –ø–æ–≤—Ç–æ—Ä—è—é –ø–æ–ø—ã—Ç–∫—É...');
                
                setTimeout(() => {
                    console.log('üîÑ –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞...');
                    if (checkAllDependencies()) {
                        initializeApplication();
                    } else {
                        showErrorScreen('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å (F12) –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.');
                    }
                }, 2000);
            }
        }
        
        window.handleLogin = function(event) {
            event.preventDefault();
            const email = document.getElementById('user-email')?.value?.trim();
            const password = document.getElementById('user-password')?.value?.trim();
            
            if (!email || !password) {
                if (window.AuthModule?.showError) {
                    AuthModule.showError('‚ùå –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                }
                return false;
            }
            
            if (window.AuthModule && typeof AuthModule.login === 'function') {
                AuthModule.login(email, password);
            }
            
            return false;
        };
        
        window.handleLogout = function() {
            if (window.AuthModule && typeof AuthModule.logout === 'function') {
                if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã?')) {
                    AuthModule.logout();
                }
            }
        };
        
        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ DOM
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üìÑ DOM –∑–∞–≥—Ä—É–∂–µ–Ω, –∑–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ...');
            updateLoadingStatus('üì¶ –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª–µ–π...', 20);
            setTimeout(startApplication, 1000);
        });
        
        // –°—Ç—Ä–∞—Ö–æ–≤–∫–∞ - –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥ –µ—Å–ª–∏ –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª–æ—Å—å
        setTimeout(function() {
            if (!window.appLoaded) {
                console.warn('‚ö†Ô∏è –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª–æ—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –∑–∞–ø—É—Å–∫–∞—é –≤—Ä—É—á–Ω—É—é...');
                startApplication();
            }
        }, 5000);
        
        console.log('‚úÖ –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∂–µ–Ω');
</script>
</body>
</html>
